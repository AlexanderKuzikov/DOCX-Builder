# DOCX-Builder

**Автор:** Alexander Kuzikov  
**Лицензия:** Apache-2.0  
**Репозиторий:** https://github.com/AlexanderKuzikov/DOCX-Builder/

**DOCX-Builder** — это комплексное решение для автоматизации подготовки юридических документов. Оно объединяет мощный движок сборки DOCX из фрагментов и удобный веб-интерфейс для управления процессом.

Программа позволяет юристам массово создавать структуру папок под судебные дела, автоматически переименовывать файлы по стандарту и собирать итоговые документы одним кликом.

## Основные возможности

### 1. Генерация структуры (Batch Generator)
- Создание папок на основе типа документа и списка кейсов.
- Пример: Ввод "Ходатайство" + выбор кейсов "Аренда", "Банкротство" -> Создаются папки "Ходатайство (Аренда)", "Ходатайство (Банкротство)".

### 2. Умное переименование (Renamer)
- Автоматическое приведение имен файлов к стандарту для корректной сортировки.
- Поддержка вложенных скобок и контекста дела.
- Конфигурация через `renamer_config.json`.
- Пример: `1_draft.docx` в папке `... (Аренда)` -> `1_Шапка (Аренда).docx`.

### 3. Сборка документов (Builder)
- Склейка DOCX файлов на уровне XML (`word/document.xml`).
- Удаление конфликтующих стилей и метаданных (`sectPr`, `paraId`).
- Поддержка "вклинивания" (1.5.docx).
- Вставка разрывов (`keepNext`) между частями.

### 4. Веб-интерфейс
- Локальный сервер на Node.js + Express.
- Управление папками, запуск процессов, настройки путей.
- "Темная тема" и компактный дизайн для профессиональной работы.

## Установка и Запуск

### Требования
- Node.js (v18+ recommended).

### Установка зависимостей
```bash
npm install
```

### Запуск
Для пользователя предусмотрен "тихий" запуск через ярлык.

1. **Обычный запуск (консоль):**
   ```bash
   node server.js
   ```

2. **Тихий запуск (без окна консоли):**
   Используйте файл `SilentStart.vbs`.

3. **Порт по умолчанию:** 5555 (можно сменить в `server.js`).

## Конфигурация

- `settings.json`: Хранит путь к рабочей директории (`inDir`). Создается автоматически через UI.
- `renamer_config.json`: Правила переименования файлов (Цифра -> Имя части).
- `cases.txt`: Список кейсов для генератора (каждый с новой строки).

## Структура проекта

- `server.js` — Бэкенд и API.
- `builder.js` — Логика сборки DOCX.
- `renamer.js` — Логика переименования.
- `public/` — Фронтенд (HTML/CSS).
- `SilentStart.vbs` — Скрипт запуска для Windows.

## Лицензия
Apache-2.0
