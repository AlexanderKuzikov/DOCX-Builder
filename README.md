# DOCX-Builder

**Автор:** Alexander Kuzikov  
**Лицензия:** Apache-2.0  
**Репозиторий:** https://github.com/AlexanderKuzikov/DOCX-Builder/

Небольшая утилита на Node.js для пакетной сборки DOCX: из набора частей в подпапках формируется один итоговый DOCX на комплект. Склейка делается на уровне OpenXML (`word/document.xml`) с мягкой очисткой проблемных секций, чтобы итоговый файл корректно открывался в Word.

## Возможности

- Пакетная обработка: `IN/<папка-комплекта>/*.docx` -> `IN/<папка-комплекта>.docx`.
- Сборка частей по порядку, заданному числовым префиксом в имени файла.
- Поддержка «вклинивания» в порядок с дробной нумерацией (например, `1.docx`, `1.5.docx`, `2.docx`).
- Между присоединяемыми частями вставляется пустая строка с параметром абзаца “Не отрывать от следующего” (`w:keepNext`).
- Из присоединяемых блоков удаляются `w:sectPr` (свойства секций), чтобы не ломать структуру документа.
- Дополнительно удаляются служебные идентификаторы (`w14:paraId`, `w14:textId`, `w:rsid*`, `w:id`) для повышения совместимости при склейке.

## Требования

- Node.js (рекомендуется LTS).
- Зависимость: `adm-zip`.

## Установка

В папке проекта:

```bash
npm install
```

Если `package.json` отсутствует, сначала:

```bash
npm init -y
npm install adm-zip
```

## Структура входных данных

В корне проекта рядом со скриптом должна быть папка `IN`.

Пример:

```text
DOCX-Builder/
  builder.js
  package.json
  IN/
    Договор_Иванов/
      1_Введение.docx
      1.5_Вставка.docx
      2_Тело.docx
      3_Подписи.docx
    Отчет_Петров/
      1.docx
      2.docx
```

После запуска будут созданы:

- `IN/Договор_Иванов.docx`
- `IN/Отчет_Петров.docx`

## Правила нумерации

- Имена файлов должны начинаться с цифры.
- Для экстренной вставки между `1` и `2` можно использовать `1.1`, `1.5`, `1.9` и т.д.
- Важное: порядок определяется числом в начале имени (используется `parseFloat`).

## Запуск

```bash
npm start
```

или

```bash
node builder.js
```

## Лицензия

Apache-2.0
